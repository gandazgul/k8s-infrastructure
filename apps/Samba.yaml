---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: samba
  namespace: default
spec:
  chart:
    spec:
      chart: samba
      version: 5.0.1
      sourceRef:
        kind: HelmRepository
        name: k8s-at-home
        namespace: flux-system
  dependsOn:
  - name: yasr-volume
  - name: main-volume
  interval: 5m
  values:
    image:
      pullPolicy: Always
    hostNetwork: true
    env:
    - name: IMPORT
      value: "/etc/samba/smbpasswd"
    - name: TZ
      value: "America/New_York"
    persistence:
      config:
        enabled: true
        existingClaim: yasr-volume
        mountPath: "/etc/samba/"
        subPath: "configs/samba/"
      shared:
        enabled: true
        existingClaim: main-volume
        mountPath: "/shared"
