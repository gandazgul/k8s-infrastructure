# STORAGE ===============================================
# This sets up all the volumes and claims that the rest of the services rely on

# NOTE: cli args take precedence over these
helmDefaults:
  wait: true
  timeout: 600
  force: true

releases:
  - name: hostpath-provisioner
    namespace: kube-system
    chart: ../charts/hostpath-provisioner

  # Yet Another SR, this is a volume for all configs
  - name: yasr-volume-pv
    namespace: default
    chart: ../charts/persistence-volume
    values:
      - volumeName: yasr-volume
      - storage: 2Ti
      - storageClass: hdd
      - path: /media/yasr
      - nodeHostname: {{ requiredEnv "MASTER_NODE_NAME" }}

  # This is the main source of storage
  - name: main-volume-pv
    namespace: default
    chart: ../charts/persistence-volume
    values:
      - volumeName: main-volume
      - storage: 4Ti
      - storageClass: hdd
      - path: /media/main
      - nodeHostname: {{ requiredEnv "MASTER_NODE_NAME" }}

  # This is the backup volume for main and some of the stuff in yasr (I know the math doesnt work but I'm on a budget)
  - name: backup-volume-pv
    namespace: default
    chart: ../charts/persistence-volume
    values:
      - volumeName: backup-volume
      - storage: 4Ti
      - storageClass: hdd
      - path: /media/backup
      - nodeHostname: {{ requiredEnv "MASTER_NODE_NAME" }}

  - name: yasr-volume
    namespace: default
    chart: ../charts/pvc
    values:
      - storageClass: hdd
      - volumeName: yasr-volume
      - storage: 2Ti

  - name: main-volume
    namespace: default
    chart: ../charts/pvc
    values:
      - storageClass: hdd
      - volumeName: main-volume
      - storage: 4Ti

  - name: backup-volume
    namespace: default
    chart: ../charts/pvc
    values:
      - storageClass: hdd
      - volumeName: backup-volume
      - storage: 4Ti
