# Gogs, Resilio Sync and Samba ===========================================================

# NOTE: cli args take precedence over these
helmDefaults:
  wait: true
  timeout: 600
  recreatePods: true
  force: true

releases:
  - name: resilio-rafag
    namespace: services
    chart: ../charts/resilio
    values:
    - image:
        repository: {{ env "RESILIO_REPOSITORY" | default "resilio/sync" }}
        tag: {{ env "RESILIO_REPOSITORY_TAG" | default "latest" }}
    - volumes:
        - name: yasr-volume
          persistentVolumeClaim:
            claimName: yasr-volume
        - name: main-volume
          persistentVolumeClaim:
            claimName: main-volume
    - values/resilio.yaml

  - name: resilio-angela
    namespace: services
    chart: ../charts/resilio
    values:
    - image:
        repository: {{ env "RESILIO_REPOSITORY" | default "resilio/sync" }}
        tag: {{ env "RESILIO_REPOSITORY_TAG" | default "latest" }}
    - env:
      - name: PUID
        value: "1001"
      - name: PGID
        value: "1002"

    - volumes:
      - name: yasr-volume
        persistentVolumeClaim:
          claimName: yasr-volume
      - name: main-volume
        persistentVolumeClaim:
          claimName: main-volume
    - volumeMounts:
      - name: yasr-volume
        mountPath: "/config"
        subPath: "configs/resilio/angela/config"
      - name: main-volume
        mountPath: "/sync"
        subPath: "angela"
    - service:
        port: 8881

  - name: resilio-haycel
    namespace: services
    chart: ../charts/resilio
    values:
    - image:
        repository: {{ env "RESILIO_REPOSITORY" | default "resilio/sync" }}
        tag: {{ env "RESILIO_REPOSITORY_TAG" | default "latest" }}
    - env:
      - name: PUID
        value: "1002"
      - name: PGID
        value: "1003"

    - volumes:
      - name: yasr-volume
        persistentVolumeClaim:
          claimName: yasr-volume
      - name: main-volume
        persistentVolumeClaim:
          claimName: main-volume
    - volumeMounts:
      - name: yasr-volume
        mountPath: "/config"
        subPath: "configs/resilio/haycel/config"
      - name: main-volume
        mountPath: "/sync"
        subPath: "haycel"
    - service:
        port: 8882

#  - name: samba
#    namespace: services
#    chart: ../charts/samba
#    values:
#      - hostNetwork: true
#      - volumes:
#          - name: yasr-volume
#            persistentVolumeClaim:
#              claimName: yasr-volume
#          - name: main-volume
#            persistentVolumeClaim:
#              claimName: main-volume
#      - volumeMounts:
#          - name: yasr-volume
#            mountPath: "/etc/samba/"
#            subPath: "configs/samba/"
#          - name: main-volume
#            mountPath: "/shared"
#      - env:
#          - name: IMPORT
#            value: "/etc/samba/smbpasswd"
#          - name: TZ
#            value: "EST5EDT"
