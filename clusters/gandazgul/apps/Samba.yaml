---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: samba
  namespace: default
spec:
  chart:
    spec:
      chart: samba
      version: 0.2.3
      sourceRef:
        kind: HelmRepository
        name: gandazgul
        namespace: flux-system
  dependsOn:
  - name: yasr-volume
  - name: main-volume
  interval: 1h0m0s
  values:
    image:
      pullPolicy: Always
    hostNetwork: true
    volumes:
    - name: yasr-volume
      persistentVolumeClaim:
        claimName: yasr-volume
    - name: main-volume
      persistentVolumeClaim:
        claimName: main-volume
    volumeMounts:
    - name: yasr-volume
      mountPath: "/etc/samba/"
      subPath: "configs/samba/"
    - name: main-volume
      mountPath: "/shared"
    env:
    - name: IMPORT
      value: "/etc/samba/smbpasswd"
    - name: TZ
      value: "EST5EDT"
